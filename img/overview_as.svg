<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="271.8px" preserveAspectRatio="none" style="width:649px;height:271px;" version="1.1" viewBox="0 0 649 271" width="649.2px" zoomAndPan="magnify"><defs><filter height="300%" id="f1m8rbyphs7ge8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4" dy="2.4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="265.0734" style="stroke:#A80036;stroke-width:0.6;" width="380.4" x="265.5" y="3.6"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacing" textLength="126.6" x="392.4" y="10.8401">Authorization Server Domain</text><line style="stroke:#A80036;stroke-width:0.6;stroke-dasharray:5.0,5.0;" x1="32.4" x2="32.4" y1="65.0578" y2="216.8953"/><line style="stroke:#A80036;stroke-width:0.6;stroke-dasharray:5.0,5.0;" x1="313.5" x2="313.5" y1="65.0578" y2="216.8953"/><line style="stroke:#A80036;stroke-width:0.6;stroke-dasharray:5.0,5.0;" x1="406.8" x2="406.8" y1="65.0578" y2="216.8953"/><line style="stroke:#A80036;stroke-width:0.6;stroke-dasharray:5.0,5.0;" x1="612.3" x2="612.3" y1="65.0578" y2="216.8953"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="55.8" x="3" y="63.0768">Relying Party</text><ellipse cx="32.7" cy="21.0797" fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" rx="4.8" ry="4.8" style="stroke:#A80036;stroke-width:1.2;"/><path d="M32.7,25.8797 L32.7,42.0797 M24.9,30.6797 L40.5,30.6797 M32.7,42.0797 L24.9,51.0797 M32.7,42.0797 L40.5,51.0797 " fill="none" filter="url(#f1m8rbyphs7ge8)" style="stroke:#A80036;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="55.8" x="3" y="224.0924">Relying Party</text><ellipse cx="32.7" cy="232.0734" fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" rx="4.8" ry="4.8" style="stroke:#A80036;stroke-width:1.2;"/><path d="M32.7,236.8734 L32.7,253.0734 M24.9,241.6734 L40.5,241.6734 M32.7,253.0734 L24.9,262.0734 M32.7,253.0734 L40.5,262.0734 " fill="none" filter="url(#f1m8rbyphs7ge8)" style="stroke:#A80036;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="87.6" x="267.9" y="63.0768">Authorization Server</text><ellipse cx="313.5" cy="21.0797" fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" rx="4.8" ry="4.8" style="stroke:#A80036;stroke-width:1.2;"/><path d="M313.5,25.8797 L313.5,42.0797 M305.7,30.6797 L321.3,30.6797 M313.5,42.0797 L305.7,51.0797 M313.5,42.0797 L321.3,51.0797 " fill="none" filter="url(#f1m8rbyphs7ge8)" style="stroke:#A80036;stroke-width:1.2;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="87.6" x="267.9" y="224.0924">Authorization Server</text><ellipse cx="313.5" cy="232.0734" fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" rx="4.8" ry="4.8" style="stroke:#A80036;stroke-width:1.2;"/><path d="M313.5,236.8734 L313.5,253.0734 M305.7,241.6734 L321.3,241.6734 M313.5,253.0734 L305.7,262.0734 M313.5,253.0734 L321.3,262.0734 " fill="none" filter="url(#f1m8rbyphs7ge8)" style="stroke:#A80036;stroke-width:1.2;"/><rect fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" height="18.1781" style="stroke:#A80036;stroke-width:0.8999999999999999;" width="78.6" x="366.6" y="43.8797"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="70.2" x="370.8" y="55.8768">Membership Svc</text><rect fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" height="18.1781" style="stroke:#A80036;stroke-width:0.8999999999999999;" width="78.6" x="366.6" y="216.2953"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="70.2" x="370.8" y="228.2924">Membership Svc</text><rect fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" height="18.1781" style="stroke:#A80036;stroke-width:0.8999999999999999;" width="60" x="581.1" y="43.8797"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="51.6" x="585.3" y="55.8768">Comparator</text><rect fill="#FEFECE" filter="url(#f1m8rbyphs7ge8)" height="18.1781" style="stroke:#A80036;stroke-width:0.8999999999999999;" width="60" x="581.1" y="216.2953"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="51.6" x="585.3" y="228.2924">Comparator</text><polygon fill="#A80036" points="306.3,81.3375,312.3,83.7375,306.3,86.1375,308.7,83.7375" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="32.7" x2="309.9" y1="83.7375" y2="83.7375"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="266.4" x="36.9" y="80.6979">GET /oauth2/authorize?client_id=123&amp;_mem=base64url-encode(vc)</text><polygon fill="#A80036" points="399.9,98.8172,405.9,101.2172,399.9,103.6172,402.3,101.2172" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="313.5" x2="403.5" y1="101.2172" y2="101.2172"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="79.2" x="317.7" y="98.1776">POST /describe {vc}</text><polygon fill="#A80036" points="320.1,116.2969,314.1,118.6969,320.1,121.0969,317.7,118.6969" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="316.5" x2="406.5" y1="118.6969" y2="118.6969"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="55.8" x="323.7" y="115.6573">{did, domain}</text><polygon fill="#A80036" points="605.1,133.7766,611.1,136.1766,605.1,138.5766,607.5,136.1766" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="313.5" x2="608.7" y1="136.1766" y2="136.1766"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="284.4" x="317.7" y="133.137">POST /accts/{accountID}/authorizations {did, vaultID, docID, exp=5min}</text><polygon fill="#A80036" points="320.1,151.2563,314.1,153.6563,320.1,156.0563,317.7,153.6563" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="316.5" x2="611.7" y1="153.6563" y2="153.6563"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="52.8" x="323.7" y="150.6167">access_token</text><polygon fill="#A80036" points="39.3,168.7359,33.3,171.1359,39.3,173.5359,36.9,171.1359" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="35.7" x2="312.9" y1="171.1359" y2="171.1359"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="125.4" x="42.9" y="168.0964">GET /oauth2/callback?code=xyz</text><polygon fill="#A80036" points="306.3,186.2156,312.3,188.6156,306.3,191.0156,308.7,188.6156" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="32.7" x2="309.9" y1="188.6156" y2="188.6156"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="183.6" x="36.9" y="185.5761">POST /oauth2/token {authorization_code=xyz}</text><polygon fill="#A80036" points="39.3,203.6953,33.3,206.0953,39.3,208.4953,36.9,206.0953" style="stroke:#A80036;stroke-width:0.6;"/><line style="stroke:#A80036;stroke-width:0.6;" x1="35.7" x2="312.9" y1="206.0953" y2="206.0953"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="52.8" x="42.9" y="203.0558">access_token</text><!--MD5=[6cd73539f12a687e0b5002b84e4bea45]
@startuml

actor "Relying Party" as rp

box "Authorization Server Domain"
  actor "Authorization Server" as as
  participant "Membership Svc" as memsvc
  participant Comparator as comp
end box

rp -> as : GET /oauth2/authorize?client_id=123&_mem=base64url-encode(vc)
as -> memsvc : POST /describe {vc}
memsvc -> as : {did, domain}
as -> comp : POST /accts/{accountID}/authorizations {did, vaultID, docID, exp=5min}
comp -> as : access_token
as -> rp : GET /oauth2/callback?code=xyz
rp -> as : POST /oauth2/token {authorization_code=xyz}
as -> rp : access_token

@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CA
--></g></svg>